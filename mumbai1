this is the full code
additional work from singapore
